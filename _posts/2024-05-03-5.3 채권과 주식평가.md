---
layout: single
title: 채권과 주식평가
use_math: true
---

```python
pip install numpy_financial
```

    Defaulting to user installation because normal site-packages is not writeable
    Looking in links: /usr/share/pip-wheels
    Requirement already satisfied: numpy_financial in /home/3fc357b7-2cd1-4096-9aa6-2150492b0b19/.local/lib/python3.11/site-packages (1.0.0)
    Requirement already satisfied: numpy>=1.15 in /opt/conda/envs/anaconda-panel-2023.05-py310/lib/python3.11/site-packages (from numpy_financial) (1.24.3)
    Note: you may need to restart the kernel to use updated packages.



```python
!conda install numpy_financial
```

    Channels:
     - defaults
    Platform: linux-64
    Collecting package metadata (repodata.json): done
    Solving environment: failed
    
    PackagesNotFoundError: The following packages are not available from current channels:
    
      - numpy_financial
    
    Current channels:
    
      - defaults
    
    To search for alternate channels that may provide the conda package you're
    looking for, navigate to
    
        https://anaconda.org
    
    and use the search bar at the top of the page.
    
    



```python
import numpy_financial as npf
```

## numpy_financial을 설치함

Bond Price 계산기


```python
npf.pv(rate=0.024,nper=3,pmt=8,fv=100,when='end')
```




    -116.0247325897217



할인율 2.4%, 3기간, 쿠폰 8인, 미래가치 계산함

YTM


```python
npf.rate(5,0.03*1000,-818,1000) 
```




    0.07498180431487073




```python
npf.rate(5,0.03*1000,-818,1000)
```




    0.07498180431487073




```python
npf.irr([-818,30,30,30,30,30+1000])
```




    0.07498180431487067




```python
818*(1.075)**5
```

수익률 변동


```python
p0=npf.pv(rate=0.04,nper=15,pmt=0,fv=-100,when='end')
p1=npf.pv(rate=0.05,nper=15,pmt=0,fv=-100,when='end')
p0,p1,(p1-p0)/p0
```




    (55.526450271327484, 48.101709809096995, -0.1337153811552842)




```python
p0=npf.pv(rate=0.04,nper=30,pmt=-0.09*100,fv=-100,when='end')
p1=npf.pv(rate=0.05,nper=30,pmt=-0.09*100,fv=-100,when='end')
p0,p1,(p1-p0)/p0
```




    (186.46016650332245, 161.48980410753137, -0.133917945393158)




```python
def durationBond(rate,couponRate,maturity):
    """
    Objective : estimte the durtion for a given bond
        rate : discount rate
        couponRate: coupon rate
        maturity : number of years
    Example 1: 
        >>>discountRate=0.1
        >>>couponRate=0.04
        >>> n=4
        >>>durationBond(0.1,0.04,4)
        3.7465335177625576
    """
    d=0
    n=maturity
    for i in range(n):
        d+=(i+1)*npf.pv(rate,i+1,0,-couponRate)
    d+=n*npf.pv(rate,n,0,-1)   #
    return d/npf.pv(rate,n,-couponRate,-1)
```

duration Bond는 채권의 듀레이션을 계산해준다 ㅇㅇ 듀레이션의 정의가 뭐더라,, 만기의 가중치임 그래서 1부터 n까지 D를 구하고 거기다가 각각의 n기를 곱해주는 것임 여기서는 (i+1)!


```python
durationBond(0.1,0.04,4)
```




    3.7465335177625576




```python
durationBond(0.04,0.09,30) ## rate = 4%, 쿠폰이자율=9%, 만기 =30)
```

Stock Evaluation


```python
npf.pv(rate=0.12,nper=1,pmt=1,fv=50,when='end')
```




    -45.535714285714285




```python
dividends=[1.80,2.07,2.2777,2.48193,2.680,2.7877]
R=0.182
g=0.03
```


```python
npf.npv(R,dividends[:-1])/(1+R)
```




    6.816796173448408




```python
npf.pv(R,5,0,2.7877/(R-g))## rate, nper, pmt, fv, when 
# note that 2.7877(R-g) = Fv
```




    -7.949046992374843




```python
(2.7877/(R-g))/((1+R)**5)
```




    7.949046992374841




```python
def pvValueNperiodModel(r,longTermGrowthRate,dividendNplus1):  # 수정본
    """
    Objective: estimate stock price based on an n-period model
        r: discount rate
        LongTermGrowhRate: long term dividend growth rate
        dividendsNpus1 : a dividend vector (n + 1)
    PV = d1/(1+R) + d2/(1+R)**2 + .... + dn/(1+R)**n + sellingPrice/(1+R)**n,
    where sellingPrice= d(n+1)/(r-g) and g is long term growth rate
    Example #1: 
        >>> r=0.182
        >>> g=0.03
        >>> d=[1.8,2.07,2.277,2.48193,2.68,2.7877]
        >>> pvValueNperiodModel(r,g,d)
           14.765419283202906
    """
    d =dividendNplus1
    n =len(d)-1
    g =longTermGrowthRate
    pv =npf.npv(r,d[:-1])/(1+r)  # ckb * -> /
    sellingPrice=d[n]/(r-g)
    pv +=npf.pv(r,n,0,-sellingPrice)
    return pv
```


```python
d=[1.80,2.07,2.277,2.48193,2.680,2.7877]
R=0.182
g=0.03

pv=0
n=5
for i  in range(0,n) : 
#    print(i)
    pv += d[i]/(1+R)**(i+1)  # ckb i-1  --> i+1
sellingPrice = d[n]/(R-g)
pv += sellingPrice/(1+R)**n
pv
```




    14.765419283202906




```python
pvValueNperiodModel(R,g,d)
```




    14.765419283202906


